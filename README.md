![Python](https://img.shields.io/badge/-Python-3776AB?style=for-the-badge&logo=python)
![ML](https://img.shields.io/badge/Machine_Learning-43B02A?style=for-the-badge)
![Scikit-learn](https://img.shields.io/badge/Scikit--Learn-F7931E?style=for-the-badge&logo=scikitlearn)
![License](https://img.shields.io/badge/Apache_2.0-blue.svg?style=for-the-badge)

# Проект: ML-прогноз погоды (умная метеостанция)

Этот репозиторий содержит код для построения модели машинного обучения, прогнозирующей:
- температуру через 6 часов
- наличие дождя через 6 часов

Модель обучена на исторических погодных данных города Basel (Швейцария), так как реальный архив с погодой для Санкт-Петербурга был недоступен. Этот датасет выбран из-за схожести климатических условий и структуры признаков с данными, получаемыми от умной метеостанции. В будущем модель планируется дообучить на собственных метеонаблюдениях

## Репозитории проекта

- [meteostation-firmware](https://github.com/finstape/meteostation-firmware) — код Arduino + ESP (этот репозиторий)
- [meteostation-backend](https://github.com/finstape/meteostation-backend) — backend-сервер (FastAPI + PostgreSQL)
- [meteostation-ml](https://github.com/finstape/meteostation-ml) — ML-модель прогнозирования погоды

## Описание файлов

| Файл             | Назначение |
|------------------|------------|
| `train.ipynb`    | Полный ноутбук с EDA, Feature Engineering, обучением моделей и сохранением |
| `weather.csv`    | Исторические погодные данные (температура, влажность, давление, дата/время) |
| `best_model.pkl` | Финальная обученная модель |
| `scaler.pkl`     | Масштабатор признаков, использованный при обучении |
| `main.py`        | Пример использования модели для предсказаний |

---

## Алгоритм

1. Загрузка и округление данных (точность = 1 знак после запятой)
2. Извлечение признаков времени (час, день, месяц)
3. Формирование целевых переменных:
   - температура через 6 часов
   - факт дождя (эвристика: высокая влажность (> 80%) + пониженное давление ( < 755))
4. Обучение моделей:
   - KNN, XGBoost, LGBM, CatBoost, Ridge и др.
5. Сравнение метрик RMSE (регрессия) и F1 (классификация)
6. Сохранение лучшей модели

## Полученные результаты

- Лучшая модель: **KNN**
- RMSE (ошибка температуры): **1.638**
- F1-score (предсказание дождя): **0.841**

## Как работает модель KNN

Алгоритм **K-ближайших соседей (KNN)** ищет K наиболее похожих наблюдений в обучающей выборке и использует их для предсказания.  
Для температуры — это усреднённые значения ближайших температур.  
Для дождя — доля "соседей", у которых был дождь, интерпретируется как вероятность.  
Модель не требует обучения в привычном смысле и показала наилучшие результаты на данной задаче

## Лицензия

Проект распространяется под лицензией **Apache License 2.0**.  
Разрешено свободное использование и модификация в образовательных и исследовательских целях